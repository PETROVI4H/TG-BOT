# Telegram Bot для работы с документами

Этот бот предназначен для того, чтобы помогать пользователям работать с различными документами, такими как Excel, Word, PDF, CSV, PowerPoint и другие. Он позволяет загружать, анализировать и выполнять различные операции с документами прямо в Telegram.

## Функции бота

### Основные команды

1. **`/start`**  
   Приветственное сообщение. После запуска бота пользователю предоставляются инструкции о том, как загрузить файл или отправить ссылку на документ для дальнейшей работы.
   
   **Пример:**
   - Приветственное сообщение с инструкциями.
   - Кнопка для перехода на сайт OMNI.

2. **`/help`**  
   Команда для получения справочной информации о функционале бота.
   
   **Пример:**
   - Список всех доступных команд и их объяснение.

3. **`/url`**  
   Команда для отправки ссылки на файл. Бот загрузит файл по ссылке и начнёт его обработку.

   **Пример:**
   - Пользователь может отправить ссылку на Google Docs, PDF, Word и другие поддерживаемые форматы. Бот загрузит файл, анализирует его и покажет содержимое.

4. **`/more`**  
   Команда для получения дополнительных результатов поиска, если их больше 5.

   **Пример:**
   - Если найдено больше 5 совпадений, бот предложит команду для получения дополнительных результатов.

### Взаимодействие с документами

1. **Загрузка файлов**
   
   Пользователь может отправить файл прямо в чат с ботом, и он будет обработан. Бот поддерживает следующие форматы:
   - Excel (`.xlsx`, `.xls`)
   - CSV (`.csv`)
   - PDF (`.pdf`)
   - PowerPoint (`.pptx`)
   - Word (`.docx`)

2. **Работа с документами**
   
   После загрузки документа бот может:
   - Извлекать и отображать текст из Word, PDF и PowerPoint файлов.
   - Загружать и обрабатывать данные из Excel и CSV файлов, позволяя пользователю работать с таблицами.

### Поиск и проверка текста

1. **Проверить наличие текста в файле**
   
   После загрузки документа бот может искать заданный текст в файле. Для этого пользователь должен ввести текст, и бот найдет строки, содержащие это слово.

   **Пример:**
   - Введите текст для поиска в загруженном документе.
   - Бот отобразит строки, которые содержат данный текст, и покажет примеры найденных строк.

2. **Проверить правильность текста**
   
   Эта функция позволяет проверить правильность написания текста, сравнив его с данными в загруженном документе. Бот использует алгоритм сравнения строк и находит наиболее подходящий вариант из документа.

   **Пример:**
   - Введите текст для проверки.
   - Бот сравнит введённый текст с содержимым документа и покажет наиболее схожие строки с оценкой схожести.

### Как использовать бота

1. **Запуск бота**
   
   Чтобы начать работу с ботом, отправьте команду `/start`. Бот поприветствует вас и предложит инструкции для загрузки файла.

2. **Загрузка файлов**
   
   Вы можете загрузить файлы в чат с ботом. Поддерживаемые форматы:
   - Excel (файлы `.xlsx`, `.xls`)
   - CSV (файл `.csv`)
   - PDF (файл `.pdf`)
   - PowerPoint (файл `.pptx`)
   - Word (файл `.docx`)

   После загрузки бота выполнит анализ содержимого файла.

3. **Отправка ссылки на файл**
   
   Вы также можете отправить ссылку на файл (например, Google Docs, Dropbox или другой доступный онлайн файл). Бот автоматически загрузит и обработает файл, после чего вы сможете работать с ним, как если бы это был локальный файл.

4. **Поиск текста**
   
   После загрузки файла используйте команду "Проверить наличие текста в файле", чтобы найти строки с заданным текстом. Просто введите текст для поиска, и бот покажет вам все совпадения.

5. **Проверка правильности текста**
   
   Если вы хотите проверить, насколько корректно написан текст, используйте команду "Проверить правильность текста". Введите текст, и бот подберет наиболее похожие строки из файла, оценивая степень совпадения.

6. **Получение дополнительных результатов поиска**
   
   Если найдено больше 5 совпадений, вы можете получить остальные результаты с помощью команды `/more`.

### Пример сценария использования

1. Пользователь запускает бота с командой `/start`.
2. Бот приветствует пользователя и предлагает загрузить файл или отправить ссылку.
3. Пользователь отправляет файл Excel.
4. Бот загружает и анализирует файл, показывая примеры данных.
5. Пользователь выбирает команду "Проверить наличие текста в файле" и вводит текст для поиска.
6. Бот находит и выводит совпадения в документе.
7. Пользователь может запросить дополнительные результаты с помощью команды `/more`.

### Возможные ошибки

1. **Неподдерживаемый формат файла**  
   Если файл имеет неподдерживаемый формат, бот сообщит об этом и предложит загрузить другой файл.

2. **Ошибка при загрузке файла по ссылке**  
   Если ссылка не действительна или не может быть загружена, бот сообщит об этом и предложит попробовать другую ссылку.
